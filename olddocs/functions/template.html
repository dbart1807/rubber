

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mat.heatmap &mdash; rage 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="rage 1.0 documentation" href="../index.html"/>
        <link rel="prev" title="mat.make" href="mat.make.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> rage</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bed.genomecov.html"><em>bed.genomecov</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="bed.genomecov.html#description">description</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.genomecov.html#usage">usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.genomecov.html#arguments">arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.genomecov.html#output">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.genomecov.html#examples">examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bed.intersect.html"><em>bed.intersect</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="bed.intersect.html#description">description</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.intersect.html#usage">usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.intersect.html#arguments">arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.intersect.html#output">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="bed.intersect.html#examples">examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mat.heatmap.html"><em>mat.heatmap</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="mat.heatmap.html#description">description</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.heatmap.html#usage">usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.heatmap.html#arguments">arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.heatmap.html#output">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.heatmap.html#examples">examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mat.make.html"><em>mat.make</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="mat.make.html#description">description</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.make.html#usage">usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.make.html#arguments">arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.make.html#value">value</a></li>
<li class="toctree-l2"><a class="reference internal" href="mat.make.html#examples">examples</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href=""><em>mat.heatmap</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arguments">arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">examples</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">rage</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li><em>mat.heatmap</em></li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/functions/template.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="mat-heatmap">
<h1><em>mat.heatmap</em><a class="headerlink" href="#mat-heatmap" title="Permalink to this headline">¶</a></h1>
<p>plot heatmaps and averages of matrices</p>
<div class="section" id="description">
<h2>description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">mat.heatmap</span></tt> generates heatmaps and averages of genomic data in matrix (.mat) files generated by mat.make. Heatmaps can be grouped and sorted based on a variety of criteria.</p>
</div>
<div class="section" id="usage">
<h2>usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre>mat.heatmap &lt;- function( mats=NULL , matnames=NULL ,
sorton=1 , numgroups=3 , sort.methods=&quot;none&quot; , sort.ranges = NA , sort.breaks = NA , gene.list = NULL ,
groupcolors=NULL , heatmap.lims=&quot;5%,95%&quot; , heatmap.colors=&quot;black,white&quot; , forcescore=TRUE ,
crossmat=NULL , matcolors=NULL ,
fragmats=NULL , fragmatnames=NULL , fragrange=c(0,200) , vplot.colors=&quot;black,blue,yellow,red&quot; , vplot.lims=&quot;0,95%&quot; ,
cores=&quot;max&quot; ){
</pre></div>
</div>
</div>
<div class="section" id="arguments">
<h2>arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Main options</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>mats</strong></td>
<td>a vector of matrix file names from which to draw heatmaps. default is NULL, which causes mat.heatmap to not produce score heatmaps.</td>
</tr>
<tr class="row-odd"><td><strong>matnames</strong></td>
<td>a character vector of names corresponding to &#8216;mats&#8217; used to label heatmaps. default is NULL, causing the matrix filenames to be used to label heatmaps</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sort/group options</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>sorton</strong></td>
<td>positive integer of index of matrix in &#8216;mats&#8217; to determine grouping/order on</td>
</tr>
<tr class="row-odd"><td><strong>numgroups</strong></td>
<td>a numeric vector which defines how many groups or clusters rows are sequentially divided into, corresponding to the sorting/clustering methods defined in ‘sorting’. For kmeans, defines how many kmeans clusters are created. For all other methods, divides genes into equally-sized groups based on the corresponding value in ‘numgroups’.</td>
</tr>
<tr class="row-even"><td><strong>sort.methods</strong></td>
<td>a vector defining how to sequentially group and/or sort the data, and when applicable, which portion of the matrix to use in determining how to sort the data. methods include kmeans,mean,median,min,max,minloc,maxloc,sd,chrom, the left and right distances (in bp) from the center of the matrix to which to limit the sorting/clustering method. In each string in sorting, sorting/clustering methods, left distance, and right distance, must be separated by a comma and not contain spaces. Clustering/grouping methods include kmeans and chromosome. Defaults to none (no sorting/clustering).</td>
</tr>
<tr class="row-odd"><td><strong>sort.ranges</strong></td>
<td>character strings indicating ranges (in bp) from the matrix center to use to apply &#8216;sort.methods&#8217;</td>
</tr>
<tr class="row-even"><td><strong>sort.breaks</strong></td>
<td>numeric vector indicating break points used to group rows using sort.methods</td>
</tr>
<tr class="row-odd"><td><strong>gene.list</strong></td>
<td>a list of character vectors of gene names, one character per group, defining the genes belonging to each group. Only used when sorting[1] is &#8220;genelist&#8221;. <strong>does not currently work</strong></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Heatmap options</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>group.colors</strong></td>
<td>a character vector of colors for each primary group, the length of which should equal numgroups[1]</td>
</tr>
<tr class="row-odd"><td><strong>heatmap.lims</strong></td>
<td>a character vector of values defining the upper and lower limits of the color gradient of the heatmaps.</td>
</tr>
<tr class="row-even"><td><strong>heatmap.colors</strong></td>
<td>a character vector of strings defining colors used to create color gradient to draw heatmap (from low scores to high scores). Colors must be separated by spaces. Defaults to “white black” where white is the lowest score and black is the highest score.</td>
</tr>
<tr class="row-odd"><td><strong>forcescore</strong></td>
<td>logical. When TRUE, before drawing the heatmap, NAs are converted to zeroes. This prevents regions with no scores from showing as white, which may hinder or distract visualization of other colors in heatmap. Defaults to TRUE.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Vplot options</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>fragmats</strong></td>
<td>a vector of fragment-matrix file names from which to draw v-plots.</td>
</tr>
<tr class="row-odd"><td><strong>fragmatnames</strong></td>
<td>a character vector of names corresponding to fragmats to label vplots</td>
</tr>
<tr class="row-even"><td><strong>fragrange</strong></td>
<td>range of fragment sizes to define y-axis in vplots.</td>
</tr>
<tr class="row-odd"><td><strong>vplot.colors</strong></td>
<td>string defining colors used to create color gradient to draw v-plot (from low scores to high scores). Colors must be separated by spaces. Defaults to “black blue yellow red” where black is the lowest scores and red is the highest score.</td>
</tr>
<tr class="row-even"><td><strong>vplot.lims</strong></td>
<td>numeric vector of length 2 that define the range of values that correspond to the color gradient edges in v-plots defined in ‘vplotcolors’. Defaults to c(“auto”,”auto”), which uses the 3 and 97 percentiles of each data set.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Misc options</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>cores</strong></td>
<td>a natural number defining the number of scorefiles to process simultaneously for each featurefile. Defaults to “max”, or all but one core.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output">
<h2>output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>mat.heatmap by default will produce one image per matrix defined in &#8216;mats&#8217;, each image containing one heatmap and one average plot. Images will be placed in a directory called &#8216;heatmaps&#8217; in the current working directory. A .sort file will also be saved in this directory that (in the future) can be used to replot other matrices or vplots with the same groups/sorting without having to redefine how to sort the matrices.</p>
</div>
<div class="section" id="examples">
<h2>examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generate-basic-heatmaps-of-a-matrices-without-reordering-rows-tsss-or-splitting-rows-into-groups">
<h3>generate basic heatmaps of a matrices without reordering rows (TSSs) or splitting rows into groups<a class="headerlink" href="#generate-basic-heatmaps-of-a-matrices-without-reordering-rows-tsss-or-splitting-rows-into-groups" title="Permalink to this headline">¶</a></h3>
<p>make a list of matrix file names</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> matrices <span class="o">&lt;-</span> c<span class="p">(</span> <span class="s">&quot;H3K36me3-signal_TSS.mat10&quot;</span> <span class="p">,</span> <span class="s">&quot;MNase-seq_TSS.mat10&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>generate heatmaps</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> mat.heatmap <span class="p">(</span> matrices <span class="p">,</span> numgroups <span class="o">=</span> <span class="m">1</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="split-tsss-into-2-equally-sized-groups-based-on-the-mean-score-100-bp-from-the-tss-of-the-first-matrix-in-mats">
<h3>split TSSs into 2 equally-sized groups based on the mean score +/- 100 bp from the TSS of the first matrix in &#8216;mats&#8217;<a class="headerlink" href="#split-tsss-into-2-equally-sized-groups-based-on-the-mean-score-100-bp-from-the-tss-of-the-first-matrix-in-mats" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> mat.heatmap <span class="p">(</span> matrices <span class="p">,</span> numgroups <span class="o">=</span> <span class="m">2</span> <span class="p">,</span> sort.methods <span class="o">=</span> <span class="s">&quot;mean&quot;</span> <span class="p">,</span> sort.ranges <span class="o">=</span> <span class="s">&quot;-100,100&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="in-addition-to-the-previous-grouping-group-each-of-the-two-groups-further-into-3-equally-sized-groups-based-on-the-location-of-highest-score-50-bp-from-the-tss">
<h3>in addition to the previous grouping, group each of the two groups further into 3 equally-sized groups based on the location of highest score +/- 50 bp from the TSS<a class="headerlink" href="#in-addition-to-the-previous-grouping-group-each-of-the-two-groups-further-into-3-equally-sized-groups-based-on-the-location-of-highest-score-50-bp-from-the-tss" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> mat.heatmap <span class="p">(</span> matrices <span class="p">,</span> numgroups <span class="o">=</span> c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="p">,</span> sort.methods <span class="o">=</span> c<span class="p">(</span> <span class="s">&quot;mean&quot;</span> <span class="p">,</span> <span class="s">&quot;maxloc&quot;</span> <span class="p">)</span> <span class="p">,</span> sort.ranges <span class="o">=</span> c<span class="p">(</span> <span class="s">&quot;-100,100&quot;</span> <span class="p">,</span> <span class="s">&quot;-50,50&quot;</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sequentially-k-means-cluster-genes-twice-into-2-groups-based-on-the-entire-region-surrounding-the-tss-in-the-matrix-of-the-first-matrix-in-mats">
<h3>sequentially k-means cluster genes twice into 2 groups based on the entire region surrounding the TSS in the matrix of the first matrix in &#8216;mats&#8217;<a class="headerlink" href="#sequentially-k-means-cluster-genes-twice-into-2-groups-based-on-the-entire-region-surrounding-the-tss-in-the-matrix-of-the-first-matrix-in-mats" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> mat.heatmap <span class="p">(</span> matrices <span class="p">,</span> numgroups <span class="o">=</span> c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">)</span> <span class="p">,</span> sort.methods <span class="o">=</span> c<span class="p">(</span> <span class="s">&quot;kmean&quot;</span> <span class="p">,</span> <span class="s">&quot;kmeans&quot;</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="mat.make.html" class="btn btn-neutral" title="mat.make"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Daniel Vera.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>